---
Title: Синхронизация с календарём Google
Weight: 65
---

:author: likhobory
:email: likhobory@mail.ru

:toc:
:toc-title: Оглавление 

:experimental:  

:imagesdir: /images/ru/admin/GoogleAPI

ifdef::env-github[:imagesdir: ./../../../../master/static/images/ru/admin/GoogleAPI]

:btn: btn:

ifdef::env-github[:btn:]

{{% notice info %}}
Синхронизация с календарём Google доступна в версии 7.11 и выше.
{{% /notice %}}

SuiteCRM может синхронизировать link:../../../user/core-modules/meetings[Встречи] с https://ru.wikipedia.org/wiki/Google_Календарь[календарём Google^]. 
Синхронизация работает в обе стороны, таким образом, обновление данных с одной стороны приведёт к обновлению данных и с другой стороны.

Обновление данных происходит напрямую между SuiteCRM и серверами Google, без участия какой-либо третьей стороны.



== Требования

=== Учётные данные

Для синхронизации данных между SuiteCRM и календарём в системе должны быть сохранены соответствующие учётные данные.

Учётные данные создаются в консоли разработчика Google, сохраняются локально в формате JSON, и загружаются в SuiteCRM.
Более детально этот процесс описан ниже.


=== Наличие доступа в интернет сервера с установленным SuiteCRM 

Сервер SuiteCRM должен иметь доступ к Интернету; сервер не обязательно должен быть общедоступным.
Для настройки процесса синхронизации пользователь системы должен иметь доступ как к консоли разработчика Google, так и к панели администрирования SuiteCRM. 
По окончании настройки процесс синхронизации выполняется автоматически по расписанию link:../system/#_Планировщик[Планировщика] без какого-либо участия со стороны пользователя.


=== Наличие как минимум одного аккаунта Google

Необходим аккаунт для создания учётных данных и аккаунт для осуществления процесса синхронизации. Это может быть один и тот же аккаунт, если в SuiteCRM зарегистрирован только один пользователь. 
Учётные данные создаются только один раз из одной учётной записи. Эти учётные данные будут использоваться для синхронизации всех пользователей после входа пользователей в свои аккаунты. 
Может использоваться как личный аккаунт Google, так и аккаунт G Suite для организаций (любой версии - Basic, Business, или Enterprise).

== Создание и установка учётных данных

=== Создание учётных данных

Войдите в свой аккаунт Google и перейдите в  
link:https://console.developers.google.com/apis/dashboard[консоль разработчика^].

[cols=",",options="!header"]
|===

|В верхней части меню выберите пункт *Выбрать проект* или нажмите на аналогичную кнопку в правой части страницы.
|image:image1.png[Google APIs - выбор проекта]

|В панели управления нажмите на кнопку {btn}[Создать].
|image:image2.png[Google APIs - создание проекта] 

|Присвойте проекту название, например, *SuiteCRM Google Sync* и нажмите на кнопку {btn}[Создать].
|image:image3.png[Google APIs - присвоение имени проекту]

|В верхней части меню выберите пункт *Выбрать проект*...
|image:image4.png[Google APIs - выбор проекта]

|...и выберите только что созданный проект.
|image:image4a.png[Google APIs - выбор созданного проекта]

|В верхней части меню нажмите на пункт *GoogleAPIs*...
|image:image5.png[Google APIs - доступ к меню]

|... после чего в левом меню выберите пункт *Библиотека*.
|image:image6.png[Google APIs - выбор библиотеки]

|В окне поиска введите *Calendar*, в результатах поиска выберите *Google Calendar API*.
|image:image7.png[Google APIs - выбор Google Calendar API]

|Нажмите на кнопку {btn}[Включить].
|image:image8.png[Google APIs - включение API]

|Теперь, когда API включено, необходимо настроить учётные данные, в правой части страницы нажмите на кнопку {btn}[Создать].
|image:image9.png[Google APIs - создание учётных данных]

|В первой части настройки установите параметры в соответствии с изображением и нажмите на кнопку {btn}[Выбрать тип учётных данных].
|image:image10.png[Google APIs - настройка учётных данных]

|Во второй части настройки добавьте название, например - SuiteCRM Google Sync, поле *Разрешённые источники JavaScript* оставьте пустым. 

В поле *Разрешённые URI перенаправления* введите `https://crm.mydomain.ru/index.php?entryPoint=saveGoogleApiKey`, где *crm.mydomain.ru*  - доменное имя сервера с установленной SuiteCRM.

Настоятельно рекомендуется включить на веб-сервере протокол https.

По окончании настройки нажмите на кнопку {btn}[Создать идентификатор клиента OAuth].
|image:image11.png[Google APIs - создание идентификатора клиента OAuth]

|В третьей части настройки укажите адрес электронной почты, название продукта, которое видят пользователи, например - SuiteCRM Calendar Sync и нажмите на кнопку {btn}[Продолжить].
|image:image12.png[Google APIs - завершение настройки учётных данных]

|На финальной станице нажмите на кнопку {btn}[Скачать] и сохраните JSON-файл с созданными учётными данными. Нажмите на кнопку {btn}[Готово].
|image:image13.png[Google APIs - сохранение JSON-файла с созданными учётными данными]

|===


=== Установка учётных данных

Войдите в систему с правами администратора и в панели администрирования перейдите подраздел *Сервисы Google* -> *Настройка Google Календарь*.

[cols=",",options="!header"]
|===

|Нажмите на кнопку {btn}[Обзор] и выберите ранее сохранённый JSON-файл с учётными данными. Нажмите на кнопку {btn}[Сохранить].
|image:image14.png[float=left]

|Вновь откройте настройки конфигурации и убедитесь, что JSON-файл установлен, о чем будет информировать соответствующая надпись.
Если необходимо обновить учётные данные - просто загрузите новый файл поверх существующего.
|image:image15.png[float=left]

|===


== Настройка доступа к календарю Google

[cols=",",options="!header"]
|===

|В меню пользователя откройте профиль текущего пользователя, выбрав пункт меню *Мои настройки*.
|image:image16.png[SuiteCRM->Мои настройки]

|Перейдите на закладку *Дополнительно*.
|image:image17.png[SuiteCRM->Мои настройки->Дополнительно]

|В подразделе *Синхронизация с календарём Google* нажмите на кнопку {btn}[Авторизация] (если подраздел не отображается на закладке, значит JSON-файл с учётными данными не был установлен - см. выше).
|image:image18.png[Синхронизация с календарём Google->Авторизация]

|Если вы используете несколько различных аккаунтов Google, то будет выдан запрос на выбор аккаунта, с которым будет производиться синхронизация. При использовании единственного аккаунта будет разу выведен аналог следующего диалога:
|image:image19.png[float=left]

|Нажмите на кнопку {btn}[Разрешить], после чего вы будете перенаправлены на страницу настроек пользователя. Если все сделано правильно, то настройки синхронизации будут выглядеть следующим образом:
|image:image20.png[Синхронизация с календарём Google->Пройденная авторизация]

|===

В конце настройки отметьте параметр *Включить синхронизацию с календарём Google* и нажмите на кнопку {btn}[Сохранить].

По умолчанию синхронизация происходит каждые 15 минут, при необходимости вы можете указать желаемый интервал синхронизации в параметрах задания *Синхронизировать с календарём Google*  на странице настроек link:../system/#_Планировщик[Планировщика].







